<template>
  <div :class="[prefixClass]">
    <div :class="[prefixClass + '__row']" v-for="i in 4" :key="i">
      <div :class="getCellClass(i, j)" v-for="j in 3" :key="j"
        v-show="((i - 1) * 3 + j - 1) <= 9"
        @click="onYearSelected(range.start + ((i - 1) * 3 + j - 1))">
        {{range.start + ((i - 1) * 3 + j - 1)}}
      </div>
    </div>
  </div>
</template>

<script>
import { compareMonth } from '../utils/util';

export default {
  name: 'ShopeeDateYearTable',
  props: {
    value: Date,
    range: Object,
    month: Number,
    min: {},
    max: {}
  },
  data() {
    return {
      prefixClass: 'shopee-year-table'
    };
  },
  methods: {
    onYearSelected(year) {
      if (this.isDisabled(year)) {
        return;
      }
      this.$emit('input', year);
    },
    isDisabled(year) {
      const currentMonth = {
        year: year,
        month: this.month
      };
      if (this.min && compareMonth(this.min, currentMonth) === 1) {
        return true;
      }
      if (this.max && compareMonth(currentMonth, this.max) === 1) {
        return true;
      }
      return false;
    },
    getCellClass(row, col) {
      const year = this.range.start + ((row - 1) * 3 + col - 1);
      return [
        this.prefixClass + '__col',
        year === new Date().getFullYear() ? 'current' : '',
        year === new Date(this.value).getFullYear() ? 'selected' : '',
        this.isDisabled(year) ? 'disabled' : ''
      ];
    }
  }
};
</script>

<style lang="css">
</style>
