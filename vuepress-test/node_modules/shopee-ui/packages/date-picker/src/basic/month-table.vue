<template>
  <div :class="[prefixClass]">
    <div :class="[prefixClass + '__row']" v-for="i in 4" :key="i">
      <div
        v-for="j in 3"
        :key="j"
        :class="getCellClass(i, j)"
        @click="onMonthSelected((i - 1) * 3 + j - 1)"
      >{{getMonthLabel(i, j)}}</div>
    </div>
  </div>
</template>

<script>
import { LocaleMixin } from 'shopee-ui/lib/base';
import { MONTHS, compareMonth } from '../utils/util';

export default {
  name: 'ShopeeDateMonthTable',
  mixins: [LocaleMixin],
  props: {
    value: Date,
    year: Number,
    min: {},
    max: {}
  },
  data() {
    return {
      prefixClass: 'shopee-month-table'
    };
  },
  methods: {
    onMonthSelected(month) {
      if (this.isDisabled(month)) {
        return;
      }
      this.$emit('input', month);
    },
    isDisabled(month) {
      const currentMonth = {
        year: this.year,
        month: month
      };
      if (this.min && compareMonth(this.min, currentMonth) === 1) {
        return true;
      }
      if (this.max && compareMonth(currentMonth, this.max) === 1) {
        return true;
      }
      return false;
    },
    getMonthLabel(row, col) {
      const month = (row - 1) * 3 + col - 1;
      return this.t(`shopee-ui.date-picker.months.short.${MONTHS[month]}`);
    },
    getCellClass(row, col) {
      const month = (row - 1) * 3 + col - 1;
      return [
        this.prefixClass + '__col',
        (this.year === new Date().getFullYear() && month === new Date().getMonth()) ? 'current' : '',
        (this.year === new Date(this.value).getFullYear() && month === new Date(this.value).getMonth()) ? 'selected' : '',
        this.isDisabled(month) ? 'disabled' : ''
      ];
    }
  }
};
</script>
