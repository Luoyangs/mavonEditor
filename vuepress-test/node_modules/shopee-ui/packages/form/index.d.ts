import Vue from 'vue';
import { ShopeeUIComponent, ShopeeUISize } from '../../types/common'

type ShopeeFormLabelPosition = 'right'|'left'|'top'
type ShopeeFormValidateTrigger = 'change'|'blur'|''
type ShopeeFormAutocomplete = 'on'|'off'

export class Form extends ShopeeUIComponent {
  // data of form
  model: Record<string, unknown>

  // validation rules of form
  rules: Record<string, unknown>

  // whether the form is inline
  inline: boolean

  // position of label
  labelPosition: ShopeeFormLabelPosition

  // the size of components in this form
  size: ShopeeUISize

  // whether to show the error message
  showMessage: boolean

  // whether to trigger validation when the rules prop is changed
  validateOnRuleChange: boolean

  // default type of trigger validation
  validateTrigger: ShopeeFormValidateTrigger

  //native autocomplete
  autocomplete: ShopeeFormAutocomplete

  // validate the whole form
  validate(callback?: () => void): Promise<{valid?: boolean, invalidFields?: Array<ShopeeFormItem>}>

  // clear validation message in whole form
  clearValidate(): void

  // validate certain form items
  validateFields(props: string | string[], callback?: () => void): Promise<{valid?: boolean, invalidFields?: Array<ShopeeFormItem>}>

  // clear validation message for certain fields
  clearValidateFields(props: string | string[]): void
}

export class FormItem extends Vue {
  // a key path of model
  prop: string

  // label of item
  label: string

  // native for property of label
  for: string

  // validation rules of item. Priority is higher than form
  rules: Record<string, unknown> | Array<Record<string, unknown>>

  // the size of components in this form item
  size: ShopeeUISize

  // whether to show the error message
  showMessage: boolean

  // validate the field in form item
  validate(trigger: ShopeeFormValidateTrigger, callback?: (valid: boolean) => void): Promise<boolean>

  // clear validation status of the field in form item
  clearValidate(): void
}

export default Form;

declare module 'vue/types/vue' {
  interface Vue {
    $formEmitter: {
      fieldChange(): void
      fieldBlur(): void
      fieldFocus(): void
    };
  }
}
