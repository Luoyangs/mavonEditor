import { EventBusMixin, isVueInstance } from 'shopee-ui/lib/base';

const dispatch = EventBusMixin.methods.dispatch;

const dispatchHandler = function(...args) {
  if (!isVueInstance(this) || !this.$parent) {
    console.warn('[ShopeeUI warn][Form]: The functions in formEmitter require a vue execution context.\nyou can use call or apply. example:\n\n    Vue.prototype.$formEmitter.fieldChange.call(this, value)');
    return;
  }
  dispatch.call(this, ...args);
};

const emitter = {
  fieldChange(value) {
    dispatchHandler.call(this, 'ShopeeFormItem', 'field-change', value);
  },
  fieldBlur(value) {
    dispatchHandler.call(this, 'ShopeeFormItem', 'field-blur', value);
  },
  fieldFocus(value) {
    dispatchHandler.call(this, 'ShopeeFormItem', 'field-focus', value);
  }
};

export default emitter;
