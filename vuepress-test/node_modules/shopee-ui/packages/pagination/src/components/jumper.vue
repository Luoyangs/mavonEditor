<template>
  <div :class="[prefixClass, 'shopee-pagination__part']">
    <span :class="[prefixClass + '__label']">{{t('shopee-ui.pagination.go-to-page')}}</span><!--
   --><div :class="[prefixClass + '__input']">
      <shopee-number-input
        change-on-enter
        :value="innerValue"
        :min="min"
        :max="actualPageCount"
        :precision="0"
        @change="onChange"
        @keydown.native.enter="onJump"></shopee-number-input><!--
   --><shopee-button
        @click="onJump">{{t('shopee-ui.pagination.go-btn')}}</shopee-button>
    </div>
  </div>
</template>
<script>
import { Button as ShopeeButton } from 'shopee-ui/lib/button';
import { NumberInput as ShopeeNumberInput } from 'shopee-ui/lib/number-input';
import { LocaleMixin } from 'shopee-ui/lib/base';

export default {
  name: 'ShopeePaginationJumper',
  components: {
    ShopeeButton,
    ShopeeNumberInput
  },
  mixins: [LocaleMixin],
  props: {
    current: Number,
    pageCount: Number,
    total: Number,
    pageSize: Number
  },
  data() {
    return {
      prefixClass: 'shopee-pagination-jumper',
      innerValue: this.current,
      min: 1
    };
  },
  computed: {
    actualPageCount() {
      return this.pageCount || Math.ceil(this.total / this.pageSize);
    }
  },
  watch: {
    current(val) {
      this.innerValue = val;
    }
  },
  methods: {
    onChange(value) {
      this.innerValue = value;
    },
    onJump(event) {
      let current = this.innerValue;
      if (Object.prototype.toString.call(event) === '[object KeyboardEvent]') {
        current = event && event.target && event.target.value;
      }

      current = Number(current);

      if (this.current !== current && !isNaN(current)) {
        this.$emit('change', current);
      }
    }
  }
};
</script>

