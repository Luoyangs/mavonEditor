let scrollBarWidth;

export const getScrollBarWidth = function () {
  if (scrollBarWidth !== undefined) {
    return scrollBarWidth;
  }

  let e = document.createElement('div');
  let sw;
  e.style.position = 'absolute';
  e.style.top = '-9999px';
  e.style.width = '100px';
  e.style.height = '100px';
  e.style.overflow = 'scroll';
  e.style.msOverflowStyle = 'scrollbar';
  document.body.appendChild(e);
  sw = (e.offsetWidth - e.clientWidth);
  document.body.removeChild(e);
  scrollBarWidth = sw;
};


/**
 * scroll animation: ease-in-out
 * @param el
 * @param scrollTo
 * @param duration
 */
export function scrollAnimation(el, scrollTo, duration) {
  const minInterval = 15;
  if (duration < minInterval) {
    el.scrollTop = scrollTo;
    return;
  }
  const scrollTop = el.scrollTop;
  const scrollHeight = scrollTo - scrollTop;
  const cosParameter = scrollHeight / 2;
  const scrollStep = Math.floor(duration / minInterval);

  let scrollCount = 0;
  let scrollMargin;
  const scrollInterval = setInterval(() => {
    if (scrollStep - scrollCount > 0) {
      scrollCount = scrollCount + 1;
      scrollMargin = cosParameter - cosParameter * Math.cos(Math.PI * scrollCount / scrollStep);
      if (Math.abs(scrollTo - scrollTop) < Math.abs(scrollMargin)) {
        el.scrollTop = scrollTo;
      } else {
        el.scrollTop = scrollTop + scrollMargin;
      }
    } else {
      clearInterval(scrollInterval);
    }
  }, minInterval);
}
