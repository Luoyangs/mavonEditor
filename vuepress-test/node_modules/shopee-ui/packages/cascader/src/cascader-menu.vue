<template>
  <transition-group name="slide-right-fast" tag="span">
    <div class="shopee-cascader-menu" :class="menuClass"
      v-for="(options, listIndex) in lists"
      :key="'m' + (listIndex + sectionIndex)"
      :style="menuContentStyle">
      <shopee-scrollbar
        layout="vertical"
        hover-visible
        :ref="'scroller_' + (listIndex + sectionIndex)">
        <div class="shopee-cascader-menu__items">
          <div class="shopee-cascader-menu__item"
            :class="{
              'active': option.active,
              'disabled': option.disabled,
              'has-children': option.children,
              'selected': option.value === selected[listIndex + sectionIndex]
            }"
            v-for="(option, optionIndex) in options"
            :key="optionIndex"
            @mouseenter="onOptionSelect(option, listIndex + sectionIndex, 'hover')"
            @click.stop="onOptionSelect(option, listIndex + sectionIndex, 'click')">
            {{option.label}}
            <shopee-icon v-if="option.children && option.children.length > 0" :svg="arrowRightIcon"></shopee-icon>
          </div>
        </div>
      </shopee-scrollbar>
      <div class="right-border" v-show="containerType === 'panel' && listIndex < maxShowLimit - 1" :style="{left: maxWidth * (listIndex + 1) + 'px'}"></div>
    </div>
  </transition-group>
</template>
<script>
import { Icon as ShopeeIcon } from 'shopee-ui/lib/icon';
import { Scrollbar as ShopeeScrollbar } from 'shopee-ui/lib/scrollbar';
import arrowRightIcon from '@shopee-ui/icon/svg/arrow-right.svg';

export default {
  name: 'ShopeeCascaderMenu',
  components: {
    ShopeeIcon,
    ShopeeScrollbar
  },
  props: {
    lists: Array,
    selected: Array,
    sectionIndex: {
      type: Number,
      default: 0
    },
    containerType: {
      type: String,
      default: ''
    },
    menuStyle: {
      type: Object,
      default() {
        return {};
      }
    },
    maxHeight: {
      type: Number,
      default: 218
    },
    maxWidth: {
      type: Number,
      default: 320
    },
    maxShowLimit: Number
  },

  data() {
    return {
      arrowRightIcon,
      visible: false,
    };
  },

  computed: {
    menuContentStyle() {
      return Object.assign({}, {'max-height': this.maxHeight + 'px', 'max-width': this.maxWidth + 'px'}, this.menuStyle);
    },
    menuClass() {
      return [
        this.containerType ? this.containerType : ''
      ];
    }
  },

  methods: {
    onOptionSelect(option, level, trigger) {
      if (option.disabled) {
        return;
      }
      this.$emit('item-select', {
        label: option.label,
        value: option.value,
        level,
        trigger
      });
    }
  }
};
</script>
