<template>
  <div :class="className" @click="handleClick">
    <div v-if="labelText" :class="labelClass">{{ labelText }}</div>
  </div>
</template>

<script>
import { EventBusMixin, FormItemMixin } from 'shopee-ui/lib/base';

export default {
  name: 'ShopeeSwitch',
  mixins: [EventBusMixin, FormItemMixin],
  props: {
    value: Boolean,
    disabled: Boolean,
    loading: Boolean,
    activeText: String,
    inactiveText: String,
    // autoLoading: Boolean,
    size: {
      type: String,
      validator(value = 'normal') {
        return ['x-large', 'large', 'normal', 'small'].indexOf(value) >= 0;
      }
    }
  },
  data() {
    return {
      prefixClass: 'shopee-switch',
    };
  },
  computed: {
    className() {
      const name = this.prefixClass;
      return {
        [name]: true,
        [`${name}--open`]: this.value,
        [`${name}--close`]: !this.value,
        [`${name}--${this.sizeClass}`]: true,
        [`${name}--loading`]: this.loading,
        [`${name}--disabled`]: this.disabled,
      };
    },
    labelText() {
      return this.value ? this.activeText : this.inactiveText;
    },
    labelClass() {
      return {
        'shopee-switch__label': true,
        'shopee-switch__label--inactive': !this.value
      };
    }
  },
  methods: {
    handleClick() {
      if (this.loading || this.disabled) {
        return;
      }
      const val = !this.value;
      this.$emit('input', val); // support v-model
      this.$emit('change', val);
      this.dispatch('ShopeeFormItem', 'field-change', val);
    },
  },
};
</script>
