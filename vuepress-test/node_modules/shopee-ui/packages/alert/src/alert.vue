<template>
  <transition name="fade-fast">
    <div
      v-if="visible"
      class="shopee-alert"
      :class="{
        ['shopee-alert--' + type]: type,
        'shopee-alert--small': small,
        'shopee-alert--with-desc': description || $slots.desc,
        'is-center': center
      }">
      <div class="shopee-alert-icon" v-if="showIcon || $slots.icon"><!--
      --><slot name="icon"><shopee-icon v-if="type" :svg="icon"></shopee-icon></slot>
      </div><!--
   --><div class="shopee-alert-content">
        <div class="shopee-alert-title"><slot></slot></div>
        <p class="shopee-alert-desc" v-if="description || $slots.desc">
          <slot name="desc">{{description}}</slot>
        </p>
      </div>
      <a class="shopee-alert-close" v-if="closable || $slots.close" @click="onClose">
        <slot name="close">
          <span v-if="closeText">{{closeText}}</span>
          <shopee-icon v-else :svg="closeIcon"></shopee-icon>
        </slot>
      </a>
    </div>
  </transition>
</template>
<script>
import { Icon as ShopeeIcon } from 'shopee-ui/lib/icon';
import successIcon from '@shopee-ui/icon/svg/success-s.svg';
import errorIcon from '@shopee-ui/icon/svg/error-s.svg';
import infoIcon from '@shopee-ui/icon/svg/infomation-s.svg';
import warningIcon from '@shopee-ui/icon/svg/notice-circle-s.svg';
import closeIcon from '@shopee-ui/icon/svg/close.svg';

export default {
  name: 'ShopeeAlert',
  components: {
    ShopeeIcon
  },
  props: {
    description: String,
    type: {
      type: String,
      default: 'info',
      validator(value = 'info') {
        return ['success', 'error', 'info', 'warning'].indexOf(value) >= 0;
      }
    },
    closable: Boolean,
    closeText: String,
    showIcon: Boolean,
    center: Boolean,
    small: Boolean
  },
  data() {
    return {
      closeIcon,
      visible: true
    };
  },
  computed: {
    icon() {
      return {
        success: successIcon,
        error: errorIcon,
        info: infoIcon,
        warning: warningIcon
      }[this.type];
    }
  },
  methods: {
    onClose(e) {
      this.visible = false;
      this.$emit('close', e);
    }
  }
};
</script>
