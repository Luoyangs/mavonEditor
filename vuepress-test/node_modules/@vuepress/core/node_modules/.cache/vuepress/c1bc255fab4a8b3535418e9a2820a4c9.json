{"remainingRequest":"/Users/luosirs/www/mavonEditor/vuepress-test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/luosirs/www/mavonEditor/vuepress-test/docs/.vuepress/components/anchor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/luosirs/www/mavonEditor/vuepress-test/docs/.vuepress/components/anchor.vue","mtime":1621148057649},{"path":"/Users/luosirs/www/mavonEditor/vuepress-test/node_modules/cache-loader/dist/cjs.js","mtime":1620802982875},{"path":"/Users/luosirs/www/mavonEditor/vuepress-test/node_modules/babel-loader/lib/index.js","mtime":1614567804373},{"path":"/Users/luosirs/www/mavonEditor/vuepress-test/node_modules/cache-loader/dist/cjs.js","mtime":1620802982875},{"path":"/Users/luosirs/www/mavonEditor/vuepress-test/node_modules/vue-loader/lib/index.js","mtime":1620802983028}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHNjcm9sbFRvcCwgZ2V0U2Nyb2xsUGFyZW50IH0gZnJvbSAnc2hvcGVlLXVpL2xpYi9iYXNlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTaG9wZWVBbmNob3InLAogIHByb3BzOiB7CiAgICBjb250YWluZXI6IFtTdHJpbmcsIEhUTUxFbGVtZW50XSwKICAgIHNjcm9sbE9mZnNldDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbmtUb3A6IDAsCiAgICAgIGFuaW1hdGluZzogZmFsc2UsIC8vIGlmIGlzIHNjcm9sbGluZyBub3cKICAgICAgY3VycmVudExpbms6ICcnLCAvLyBjdXJyZW50IHNob3cgbGluayA9PiAgI2hyZWYgLT4gY3VycmVudExpbmsgPSAjaHJlZgogICAgICBjdXJyZW50SWQ6ICcnLCAvLyBjdXJyZW50IHNob3cgdGl0bGUgaWQgPT4gICNocmVmIC0+IGN1cnJlbnRJZCA9IGhyZWYKICAgICAgdGl0bGVzT2Zmc2V0czogW10sCiAgICAgIHdyYXBwZXJUb3A6IDAKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgc2Nyb2xsQ29udGFpbmVyKCkgewogICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjsKICAgICAgcmV0dXJuIGNvbnRhaW5lciA/ICh0eXBlb2YgY29udGFpbmVyID09PSAnc3RyaW5nJyA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKSA6IGNvbnRhaW5lcikgOiBnZXRTY3JvbGxQYXJlbnQodGhpcy4kZWwpOwogICAgfSwKICAgIHNjcm9sbEVsZW1lbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lciA/IHRoaXMuc2Nyb2xsQ29udGFpbmVyIDogKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCB8fCBkb2N1bWVudC5ib2R5KTsKICAgIH0sCiAgICBjb250YWluZXJJc1dpbmRvdygpIHsKICAgICAgcmV0dXJuIHRoaXMuc2Nyb2xsQ29udGFpbmVyID09PSB3aW5kb3c7CiAgICB9LAogICAgYWxsQW5jaG9yTGlua3MoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldEFuY2hvckl0ZW1zKHRoaXMuJGNoaWxkcmVuKTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAnJHJvdXRlJygpIHsKICAgICAgdGhpcy5oYW5kbGVIYXNoQ2hhbmdlKCk7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLmhhbmRsZVNjcm9sbFRvKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGNvbnRhaW5lcigpIHsKICAgICAgdGhpcy5pbml0KCk7CiAgICB9LAogICAgY3VycmVudExpbmsobmV3SHJlZiwgb2xkSHJlZikgewogICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCBuZXdIcmVmLCBvbGRIcmVmKTsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRBbmNob3JJdGVtcyhjaGlsZHJlbikgewogICAgICBjb25zdCBpdGVtcyA9IFtdOwogICAgICBpZiAoY2hpbGRyZW4gJiYgY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7CiAgICAgICAgICBpZiAoY2hpbGQuJG9wdGlvbnMubmFtZSA9PT0gJ1Nob3BlZUFuY2hvckl0ZW0nKSB7CiAgICAgICAgICAgIGl0ZW1zLnB1c2goY2hpbGQpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGNoaWxkLiRjaGlsZHJlbikgewogICAgICAgICAgICBpdGVtcy5wdXNoKC4uLnRoaXMuZ2V0QW5jaG9ySXRlbXMoY2hpbGQuJGNoaWxkcmVuKSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpdGVtczsKICAgIH0sCiAgICBoYW5kbGVTY3JvbGwoZSkgewogICAgICBpZiAodGhpcy5hbmltYXRpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy51cGRhdGVUaXRsZU9mZnNldCgpOwogICAgICBjb25zdCBzY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8CiAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgfHwKICAgICAgICBlLnRhcmdldC5zY3JvbGxUb3A7CiAgICAgIHRoaXMuZ2V0Q3VycmVudFNjcm9sbEF0VGl0bGVJZChzY3JvbGxUb3AgKyAgdGhpcy5zY3JvbGxPZmZzZXQpOwogICAgfSwKICAgIGhhbmRsZUhhc2hDaGFuZ2UoKSB7CiAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOwogICAgICBjb25zdCBzaGFycExpbmtNYXRjaCA9IC8jKFteI10rKSQvLmV4ZWModXJsKTsKCiAgICAgIGlmICghc2hhcnBMaW5rTWF0Y2gpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5jdXJyZW50TGluayA9IHNoYXJwTGlua01hdGNoWzBdOwogICAgICB0aGlzLmN1cnJlbnRJZCA9IHNoYXJwTGlua01hdGNoWzFdOwogICAgfSwKICAgIGhhbmRsZVNjcm9sbFRvKCkgewogICAgICBjb25zdCBhbmNob3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmN1cnJlbnRJZCk7CiAgICAgIGlmICghYW5jaG9yKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBvZmZzZXRUb3AgPSBhbmNob3Iub2Zmc2V0VG9wIC0gdGhpcy53cmFwcGVyVG9wIC0gdGhpcy5zY3JvbGxPZmZzZXQ7CiAgICAgIHRoaXMuYW5pbWF0aW5nID0gdHJ1ZTsKICAgICAgc2Nyb2xsVG9wKHRoaXMuc2Nyb2xsQ29udGFpbmVyLCB0aGlzLnNjcm9sbEVsZW1lbnQuc2Nyb2xsVG9wLCBvZmZzZXRUb3AsIDYwMCwgKCkgPT4gewogICAgICAgIHRoaXMuYW5pbWF0aW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgICB0aGlzLmhhbmRsZVNldElua1RvcCgpOwogICAgfSwKICAgIGhhbmRsZVNldElua1RvcCgpIHsKICAgICAgY29uc3QgY3VycmVudExpbmtFbGVtZW50QSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGFbZGF0YS1ocmVmPSIke3RoaXMuY3VycmVudExpbmt9Il1gKTsKICAgICAgaWYgKCFjdXJyZW50TGlua0VsZW1lbnRBKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGVsZW1lbnRBVG9wID0gY3VycmVudExpbmtFbGVtZW50QS5vZmZzZXRUb3A7CiAgICAgIGNvbnN0IHRvcCA9IChlbGVtZW50QVRvcCA8IDAgPyB0aGlzLm9mZnNldFRvcCA6IGVsZW1lbnRBVG9wKTsKICAgICAgdGhpcy5pbmtUb3AgPSB0b3A7CiAgICB9LAogICAgdXBkYXRlVGl0bGVPZmZzZXQoKSB7CiAgICAgIGNvbnN0IGxpbmtzID0gdGhpcy5hbGxBbmNob3JMaW5rcy5tYXAobGluayA9PiBsaW5rLmhyZWYpOwogICAgICBjb25zdCBpZEFyciA9IGxpbmtzLm1hcChsaW5rID0+IGxpbmsuc3BsaXQoJyMnKVsxXSk7CiAgICAgIGxldCBvZmZzZXRBcnIgPSBbXTsKICAgICAgaWRBcnIuZm9yRWFjaChpZCA9PiB7CiAgICAgICAgY29uc3QgdGl0bGVFbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICAgICAgaWYgKHRpdGxlRWxlKSB7CiAgICAgICAgICBvZmZzZXRBcnIucHVzaCh7CiAgICAgICAgICAgIGxpbms6IGAjJHtpZH1gLAogICAgICAgICAgICBvZmZzZXQ6IHRpdGxlRWxlLm9mZnNldFRvcCAtIHRoaXMuc2Nyb2xsRWxlbWVudC5vZmZzZXRUb3AKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0aGlzLnRpdGxlc09mZnNldHMgPSBvZmZzZXRBcnI7CiAgICB9LAogICAgZ2V0Q3VycmVudFNjcm9sbEF0VGl0bGVJZChzY3JvbGxUb3ApIHsKICAgICAgbGV0IGkgPSAtMTsKICAgICAgbGV0IGxlbiA9IHRoaXMudGl0bGVzT2Zmc2V0cy5sZW5ndGg7CiAgICAgIGxldCB0aXRsZUl0ZW0gPSB7CiAgICAgICAgbGluazogJyMnLAogICAgICAgIG9mZnNldDogMAogICAgICB9OwogICAgICB3aGlsZSAoKytpIDwgbGVuKSB7CiAgICAgICAgbGV0IGN1cnJlbnRFbGUgPSB0aGlzLnRpdGxlc09mZnNldHNbaV07CiAgICAgICAgbGV0IG5leHRFbGUgPSB0aGlzLnRpdGxlc09mZnNldHNbaSArIDFdOwogICAgICAgIGlmIChzY3JvbGxUb3AgPj0gY3VycmVudEVsZS5vZmZzZXQgJiYgc2Nyb2xsVG9wIDwgKChuZXh0RWxlICYmIG5leHRFbGUub2Zmc2V0KSB8fCBJbmZpbml0eSkpIHsKICAgICAgICAgIHRpdGxlSXRlbSA9IHRoaXMudGl0bGVzT2Zmc2V0c1tpXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmN1cnJlbnRMaW5rID0gdGl0bGVJdGVtLmxpbms7CiAgICAgIHRoaXMuaGFuZGxlU2V0SW5rVG9wKCk7CiAgICB9LAogICAgcmVtb3ZlTGlzdGVuZXIoKSB7CiAgICAgIHRoaXMuc2Nyb2xsQ29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuaGFuZGxlU2Nyb2xsLCBmYWxzZSk7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5oYW5kbGVIYXNoQ2hhbmdlLCBmYWxzZSk7CiAgICB9LAogICAgaW5pdCgpIHsKICAgICAgdGhpcy5oYW5kbGVIYXNoQ2hhbmdlKCk7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKCk7CiAgICAgICAgdGhpcy53cmFwcGVyVG9wID0gdGhpcy5jb250YWluZXJJc1dpbmRvdyA/IDAgOiB0aGlzLnNjcm9sbEVsZW1lbnQub2Zmc2V0VG9wOwogICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsVG8oKTsKICAgICAgICB0aGlzLmhhbmRsZVNldElua1RvcCgpOwogICAgICAgIHRoaXMudXBkYXRlVGl0bGVPZmZzZXQoKTsKCiAgICAgICAgdGhpcy5zY3JvbGxDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5oYW5kbGVTY3JvbGwsIGZhbHNlKTsKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMuaGFuZGxlSGFzaENoYW5nZSwgZmFsc2UpOwogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["anchor.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"anchor.vue","sourceRoot":"docs/.vuepress/components","sourcesContent":["<template>\n  <div class=\"shopee-anchor__wrapper\">\n    <div class=\"shopee-anchor\">\n      <div class=\"shopee-anchor__ink\">\n        <span class=\"shopee-anchor__ink-ball\" :style=\"{top: `${inkTop}px`}\"></span>\n      </div>\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script>\nimport { scrollTop, getScrollParent } from 'shopee-ui/lib/base';\nexport default {\n  name: 'ShopeeAnchor',\n  props: {\n    container: [String, HTMLElement],\n    scrollOffset: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      inkTop: 0,\n      animating: false, // if is scrolling now\n      currentLink: '', // current show link =>  #href -> currentLink = #href\n      currentId: '', // current show title id =>  #href -> currentId = href\n      titlesOffsets: [],\n      wrapperTop: 0\n    };\n  },\n  computed: {\n    scrollContainer() {\n      const container = this.container;\n      return container ? (typeof container === 'string' ? document.querySelector(container) : container) : getScrollParent(this.$el);\n    },\n    scrollElement() {\n      return this.container ? this.scrollContainer : (document.documentElement || document.body);\n    },\n    containerIsWindow() {\n      return this.scrollContainer === window;\n    },\n    allAnchorLinks() {\n      return this.getAnchorItems(this.$children);\n    }\n  },\n  watch: {\n    '$route'() {\n      this.handleHashChange();\n      this.$nextTick(() => {\n        this.handleScrollTo();\n      });\n    },\n    container() {\n      this.init();\n    },\n    currentLink(newHref, oldHref) {\n      this.$emit('change', newHref, oldHref);\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  beforeDestroy() {\n    this.removeListener();\n  },\n  methods: {\n    getAnchorItems(children) {\n      const items = [];\n      if (children && children.length) {\n        children.forEach(child => {\n          if (child.$options.name === 'ShopeeAnchorItem') {\n            items.push(child);\n          }\n          if (child.$children) {\n            items.push(...this.getAnchorItems(child.$children));\n          }\n        });\n      }\n\n      return items;\n    },\n    handleScroll(e) {\n      if (this.animating) {\n        return;\n      }\n      this.updateTitleOffset();\n      const scrollTop = document.documentElement.scrollTop ||\n        document.body.scrollTop ||\n        e.target.scrollTop;\n      this.getCurrentScrollAtTitleId(scrollTop +  this.scrollOffset);\n    },\n    handleHashChange() {\n      const url = window.location.href;\n      const sharpLinkMatch = /#([^#]+)$/.exec(url);\n\n      if (!sharpLinkMatch) {\n        return;\n      }\n      this.currentLink = sharpLinkMatch[0];\n      this.currentId = sharpLinkMatch[1];\n    },\n    handleScrollTo() {\n      const anchor = document.getElementById(this.currentId);\n      if (!anchor) {\n        return;\n      }\n\n      const offsetTop = anchor.offsetTop - this.wrapperTop - this.scrollOffset;\n      this.animating = true;\n      scrollTop(this.scrollContainer, this.scrollElement.scrollTop, offsetTop, 600, () => {\n        this.animating = false;\n      });\n      this.handleSetInkTop();\n    },\n    handleSetInkTop() {\n      const currentLinkElementA = document.querySelector(`a[data-href=\"${this.currentLink}\"]`);\n      if (!currentLinkElementA) {\n        return;\n      }\n      const elementATop = currentLinkElementA.offsetTop;\n      const top = (elementATop < 0 ? this.offsetTop : elementATop);\n      this.inkTop = top;\n    },\n    updateTitleOffset() {\n      const links = this.allAnchorLinks.map(link => link.href);\n      const idArr = links.map(link => link.split('#')[1]);\n      let offsetArr = [];\n      idArr.forEach(id => {\n        const titleEle = document.getElementById(id);\n        if (titleEle) {\n          offsetArr.push({\n            link: `#${id}`,\n            offset: titleEle.offsetTop - this.scrollElement.offsetTop\n          });\n        }\n      });\n\n      this.titlesOffsets = offsetArr;\n    },\n    getCurrentScrollAtTitleId(scrollTop) {\n      let i = -1;\n      let len = this.titlesOffsets.length;\n      let titleItem = {\n        link: '#',\n        offset: 0\n      };\n      while (++i < len) {\n        let currentEle = this.titlesOffsets[i];\n        let nextEle = this.titlesOffsets[i + 1];\n        if (scrollTop >= currentEle.offset && scrollTop < ((nextEle && nextEle.offset) || Infinity)) {\n          titleItem = this.titlesOffsets[i];\n          break;\n        }\n      }\n      this.currentLink = titleItem.link;\n      this.handleSetInkTop();\n    },\n    removeListener() {\n      this.scrollContainer.removeEventListener('scroll', this.handleScroll, false);\n      window.removeEventListener('hashchange', this.handleHashChange, false);\n    },\n    init() {\n      this.handleHashChange();\n      this.$nextTick(() => {\n        this.removeListener();\n        this.wrapperTop = this.containerIsWindow ? 0 : this.scrollElement.offsetTop;\n        this.handleScrollTo();\n        this.handleSetInkTop();\n        this.updateTitleOffset();\n\n        this.scrollContainer.addEventListener('scroll', this.handleScroll, false);\n        window.addEventListener('hashchange', this.handleHashChange, false);\n      });\n    }\n  }\n};\n</script>\n"]}]}